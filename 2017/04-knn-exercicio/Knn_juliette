{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/juliette/miniconda3/envs/juliette/lib/python3.6/site-packages/matplotlib/font_manager.py:279: UserWarning: Matplotlib is building the font cache using fc-list. This may take a moment.\n",
      "  'Matplotlib is building the font cache using fc-list. '\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "from sklearn import datasets\n",
    "from sklearn.neighbors import DistanceMetric\n",
    "from collections import Counter\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import accuracy_score, classification_report\n",
    "import math\n",
    "from sklearn.model_selection import train_test_split\n",
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "import pandas as pd\n",
    "from sklearn.preprocessing import LabelEncoder\n",
    "from sklearn.neighbors import KNeighborsClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "class KNNClassifier(object):\n",
    "    def __init__(self):\n",
    "        self.X_train = None\n",
    "        self.y_train = None\n",
    "\n",
    "    def euc_distance(self, a, b):\n",
    "        return DistanceMetric.get_metric('euclidean').pairwise([a],[b])[0][0]\n",
    "\n",
    "    def closest(self, row):\n",
    "\n",
    "        dists = [self.euc_distance(row, item) for item in self.X_train]\n",
    "        nei = dists.index(min(dists))\n",
    "        return self.y_train[nei]\n",
    "    \n",
    "    def k_closest(self, row, k):\n",
    "        dists = [(index,self.euc_distance(row, item)) for index,item in enumerate(self.X_train)]\n",
    "        dists.sort(key = lambda x: x[1])\n",
    "        vizinhos = []\n",
    "        for i in range(k):\n",
    "            vizinhos.append(self.y_train[dists[i][0]])\n",
    "        classe = Counter(vizinhos).most_common(1)[0][0]\n",
    "        \n",
    "        return classe\n",
    "\n",
    "    def fit(self, training_data, training_labels):\n",
    "        self.X_train = training_data\n",
    "        self.y_train = training_labels\n",
    "\n",
    "    def predict(self, to_classify, k=3):\n",
    "        predictions = []\n",
    "        for row in to_classify:\n",
    "            label = self.k_closest(row, k)\n",
    "            predictions.append(label)\n",
    "        return predictions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PassengerId</th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Name</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Ticket</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Cabin</th>\n",
       "      <th>Embarked</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Braund, Mr. Owen Harris</td>\n",
       "      <td>male</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>A/5 21171</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>\n",
       "      <td>female</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>PC 17599</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>C85</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Heikkinen, Miss. Laina</td>\n",
       "      <td>female</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>STON/O2. 3101282</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>\n",
       "      <td>female</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>113803</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>C123</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Allen, Mr. William Henry</td>\n",
       "      <td>male</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>373450</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Moran, Mr. James</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>330877</td>\n",
       "      <td>8.4583</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>McCarthy, Mr. Timothy J</td>\n",
       "      <td>male</td>\n",
       "      <td>54.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>17463</td>\n",
       "      <td>51.8625</td>\n",
       "      <td>E46</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Palsson, Master. Gosta Leonard</td>\n",
       "      <td>male</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>349909</td>\n",
       "      <td>21.0750</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)</td>\n",
       "      <td>female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>347742</td>\n",
       "      <td>11.1333</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Nasser, Mrs. Nicholas (Adele Achem)</td>\n",
       "      <td>female</td>\n",
       "      <td>14.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>237736</td>\n",
       "      <td>30.0708</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Sandstrom, Miss. Marguerite Rut</td>\n",
       "      <td>female</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>PP 9549</td>\n",
       "      <td>16.7000</td>\n",
       "      <td>G6</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Bonnell, Miss. Elizabeth</td>\n",
       "      <td>female</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>113783</td>\n",
       "      <td>26.5500</td>\n",
       "      <td>C103</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Saundercock, Mr. William Henry</td>\n",
       "      <td>male</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>A/5. 2151</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Andersson, Mr. Anders Johan</td>\n",
       "      <td>male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>347082</td>\n",
       "      <td>31.2750</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Vestrom, Miss. Hulda Amanda Adolfina</td>\n",
       "      <td>female</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>350406</td>\n",
       "      <td>7.8542</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>16</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Hewlett, Mrs. (Mary D Kingcome)</td>\n",
       "      <td>female</td>\n",
       "      <td>55.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>248706</td>\n",
       "      <td>16.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>17</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Rice, Master. Eugene</td>\n",
       "      <td>male</td>\n",
       "      <td>2.0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>382652</td>\n",
       "      <td>29.1250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Williams, Mr. Charles Eugene</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>244373</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Vander Planke, Mrs. Julius (Emelia Maria Vande...</td>\n",
       "      <td>female</td>\n",
       "      <td>31.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>345763</td>\n",
       "      <td>18.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Masselmani, Mrs. Fatima</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2649</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>21</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>Fynney, Mr. Joseph J</td>\n",
       "      <td>male</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>239865</td>\n",
       "      <td>26.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>22</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Beesley, Mr. Lawrence</td>\n",
       "      <td>male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>248698</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>D56</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>23</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>McGowan, Miss. Anna \"Annie\"</td>\n",
       "      <td>female</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>330923</td>\n",
       "      <td>8.0292</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>24</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Sloper, Mr. William Thompson</td>\n",
       "      <td>male</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>113788</td>\n",
       "      <td>35.5000</td>\n",
       "      <td>A6</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Palsson, Miss. Torborg Danira</td>\n",
       "      <td>female</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>349909</td>\n",
       "      <td>21.0750</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>26</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Asplund, Mrs. Carl Oscar (Selma Augusta Emilia...</td>\n",
       "      <td>female</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>347077</td>\n",
       "      <td>31.3875</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Emir, Mr. Farred Chehab</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2631</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>28</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>Fortune, Mr. Charles Alexander</td>\n",
       "      <td>male</td>\n",
       "      <td>19.0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>19950</td>\n",
       "      <td>263.0000</td>\n",
       "      <td>C23 C25 C27</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>29</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>O'Dwyer, Miss. Ellen \"Nellie\"</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>330959</td>\n",
       "      <td>7.8792</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>30</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Todoroff, Mr. Lalio</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>349216</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>861</th>\n",
       "      <td>862</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>Giles, Mr. Frederick Edward</td>\n",
       "      <td>male</td>\n",
       "      <td>21.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>28134</td>\n",
       "      <td>11.5000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>862</th>\n",
       "      <td>863</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Swift, Mrs. Frederick Joel (Margaret Welles Ba...</td>\n",
       "      <td>female</td>\n",
       "      <td>48.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>17466</td>\n",
       "      <td>25.9292</td>\n",
       "      <td>D17</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>863</th>\n",
       "      <td>864</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Sage, Miss. Dorothy Edith \"Dolly\"</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>CA. 2343</td>\n",
       "      <td>69.5500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>864</th>\n",
       "      <td>865</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>Gill, Mr. John William</td>\n",
       "      <td>male</td>\n",
       "      <td>24.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>233866</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>865</th>\n",
       "      <td>866</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Bystrom, Mrs. (Karolina)</td>\n",
       "      <td>female</td>\n",
       "      <td>42.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>236852</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>866</th>\n",
       "      <td>867</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Duran y More, Miss. Asuncion</td>\n",
       "      <td>female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>SC/PARIS 2149</td>\n",
       "      <td>13.8583</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>867</th>\n",
       "      <td>868</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>Roebling, Mr. Washington Augustus II</td>\n",
       "      <td>male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>PC 17590</td>\n",
       "      <td>50.4958</td>\n",
       "      <td>A24</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>868</th>\n",
       "      <td>869</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>van Melkebeke, Mr. Philemon</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>345777</td>\n",
       "      <td>9.5000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>869</th>\n",
       "      <td>870</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Johnson, Master. Harold Theodor</td>\n",
       "      <td>male</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>347742</td>\n",
       "      <td>11.1333</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>870</th>\n",
       "      <td>871</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Balkic, Mr. Cerin</td>\n",
       "      <td>male</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>349248</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>871</th>\n",
       "      <td>872</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Beckwith, Mrs. Richard Leonard (Sallie Monypeny)</td>\n",
       "      <td>female</td>\n",
       "      <td>47.0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>11751</td>\n",
       "      <td>52.5542</td>\n",
       "      <td>D35</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>872</th>\n",
       "      <td>873</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>Carlsson, Mr. Frans Olof</td>\n",
       "      <td>male</td>\n",
       "      <td>33.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>695</td>\n",
       "      <td>5.0000</td>\n",
       "      <td>B51 B53 B55</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>873</th>\n",
       "      <td>874</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Vander Cruyssen, Mr. Victor</td>\n",
       "      <td>male</td>\n",
       "      <td>47.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>345765</td>\n",
       "      <td>9.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>874</th>\n",
       "      <td>875</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Abelson, Mrs. Samuel (Hannah Wizosky)</td>\n",
       "      <td>female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>P/PP 3381</td>\n",
       "      <td>24.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>875</th>\n",
       "      <td>876</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Najib, Miss. Adele Kiamie \"Jane\"</td>\n",
       "      <td>female</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2667</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>876</th>\n",
       "      <td>877</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Gustafsson, Mr. Alfred Ossian</td>\n",
       "      <td>male</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7534</td>\n",
       "      <td>9.8458</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>877</th>\n",
       "      <td>878</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Petroff, Mr. Nedelio</td>\n",
       "      <td>male</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>349212</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>878</th>\n",
       "      <td>879</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Laleff, Mr. Kristo</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>349217</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>879</th>\n",
       "      <td>880</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Potter, Mrs. Thomas Jr (Lily Alexenia Wilson)</td>\n",
       "      <td>female</td>\n",
       "      <td>56.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>11767</td>\n",
       "      <td>83.1583</td>\n",
       "      <td>C50</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>880</th>\n",
       "      <td>881</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Shelley, Mrs. William (Imanita Parrish Hall)</td>\n",
       "      <td>female</td>\n",
       "      <td>25.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>230433</td>\n",
       "      <td>26.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>881</th>\n",
       "      <td>882</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Markun, Mr. Johann</td>\n",
       "      <td>male</td>\n",
       "      <td>33.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>349257</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>882</th>\n",
       "      <td>883</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Dahlberg, Miss. Gerda Ulrika</td>\n",
       "      <td>female</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7552</td>\n",
       "      <td>10.5167</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>883</th>\n",
       "      <td>884</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>Banfield, Mr. Frederick James</td>\n",
       "      <td>male</td>\n",
       "      <td>28.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>C.A./SOTON 34068</td>\n",
       "      <td>10.5000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>884</th>\n",
       "      <td>885</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Sutehall, Mr. Henry Jr</td>\n",
       "      <td>male</td>\n",
       "      <td>25.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>SOTON/OQ 392076</td>\n",
       "      <td>7.0500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>885</th>\n",
       "      <td>886</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Rice, Mrs. William (Margaret Norton)</td>\n",
       "      <td>female</td>\n",
       "      <td>39.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>382652</td>\n",
       "      <td>29.1250</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>886</th>\n",
       "      <td>887</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>Montvila, Rev. Juozas</td>\n",
       "      <td>male</td>\n",
       "      <td>27.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>211536</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>887</th>\n",
       "      <td>888</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Graham, Miss. Margaret Edith</td>\n",
       "      <td>female</td>\n",
       "      <td>19.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>112053</td>\n",
       "      <td>30.0000</td>\n",
       "      <td>B42</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>888</th>\n",
       "      <td>889</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Johnston, Miss. Catherine Helen \"Carrie\"</td>\n",
       "      <td>female</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>W./C. 6607</td>\n",
       "      <td>23.4500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>S</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>889</th>\n",
       "      <td>890</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Behr, Mr. Karl Howell</td>\n",
       "      <td>male</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>111369</td>\n",
       "      <td>30.0000</td>\n",
       "      <td>C148</td>\n",
       "      <td>C</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>890</th>\n",
       "      <td>891</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Dooley, Mr. Patrick</td>\n",
       "      <td>male</td>\n",
       "      <td>32.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>370376</td>\n",
       "      <td>7.7500</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Q</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>891 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     PassengerId  Survived  Pclass  \\\n",
       "0              1         0       3   \n",
       "1              2         1       1   \n",
       "2              3         1       3   \n",
       "3              4         1       1   \n",
       "4              5         0       3   \n",
       "5              6         0       3   \n",
       "6              7         0       1   \n",
       "7              8         0       3   \n",
       "8              9         1       3   \n",
       "9             10         1       2   \n",
       "10            11         1       3   \n",
       "11            12         1       1   \n",
       "12            13         0       3   \n",
       "13            14         0       3   \n",
       "14            15         0       3   \n",
       "15            16         1       2   \n",
       "16            17         0       3   \n",
       "17            18         1       2   \n",
       "18            19         0       3   \n",
       "19            20         1       3   \n",
       "20            21         0       2   \n",
       "21            22         1       2   \n",
       "22            23         1       3   \n",
       "23            24         1       1   \n",
       "24            25         0       3   \n",
       "25            26         1       3   \n",
       "26            27         0       3   \n",
       "27            28         0       1   \n",
       "28            29         1       3   \n",
       "29            30         0       3   \n",
       "..           ...       ...     ...   \n",
       "861          862         0       2   \n",
       "862          863         1       1   \n",
       "863          864         0       3   \n",
       "864          865         0       2   \n",
       "865          866         1       2   \n",
       "866          867         1       2   \n",
       "867          868         0       1   \n",
       "868          869         0       3   \n",
       "869          870         1       3   \n",
       "870          871         0       3   \n",
       "871          872         1       1   \n",
       "872          873         0       1   \n",
       "873          874         0       3   \n",
       "874          875         1       2   \n",
       "875          876         1       3   \n",
       "876          877         0       3   \n",
       "877          878         0       3   \n",
       "878          879         0       3   \n",
       "879          880         1       1   \n",
       "880          881         1       2   \n",
       "881          882         0       3   \n",
       "882          883         0       3   \n",
       "883          884         0       2   \n",
       "884          885         0       3   \n",
       "885          886         0       3   \n",
       "886          887         0       2   \n",
       "887          888         1       1   \n",
       "888          889         0       3   \n",
       "889          890         1       1   \n",
       "890          891         0       3   \n",
       "\n",
       "                                                  Name     Sex   Age  SibSp  \\\n",
       "0                              Braund, Mr. Owen Harris    male  22.0      1   \n",
       "1    Cumings, Mrs. John Bradley (Florence Briggs Th...  female  38.0      1   \n",
       "2                               Heikkinen, Miss. Laina  female  26.0      0   \n",
       "3         Futrelle, Mrs. Jacques Heath (Lily May Peel)  female  35.0      1   \n",
       "4                             Allen, Mr. William Henry    male  35.0      0   \n",
       "5                                     Moran, Mr. James    male   NaN      0   \n",
       "6                              McCarthy, Mr. Timothy J    male  54.0      0   \n",
       "7                       Palsson, Master. Gosta Leonard    male   2.0      3   \n",
       "8    Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)  female  27.0      0   \n",
       "9                  Nasser, Mrs. Nicholas (Adele Achem)  female  14.0      1   \n",
       "10                     Sandstrom, Miss. Marguerite Rut  female   4.0      1   \n",
       "11                            Bonnell, Miss. Elizabeth  female  58.0      0   \n",
       "12                      Saundercock, Mr. William Henry    male  20.0      0   \n",
       "13                         Andersson, Mr. Anders Johan    male  39.0      1   \n",
       "14                Vestrom, Miss. Hulda Amanda Adolfina  female  14.0      0   \n",
       "15                    Hewlett, Mrs. (Mary D Kingcome)   female  55.0      0   \n",
       "16                                Rice, Master. Eugene    male   2.0      4   \n",
       "17                        Williams, Mr. Charles Eugene    male   NaN      0   \n",
       "18   Vander Planke, Mrs. Julius (Emelia Maria Vande...  female  31.0      1   \n",
       "19                             Masselmani, Mrs. Fatima  female   NaN      0   \n",
       "20                                Fynney, Mr. Joseph J    male  35.0      0   \n",
       "21                               Beesley, Mr. Lawrence    male  34.0      0   \n",
       "22                         McGowan, Miss. Anna \"Annie\"  female  15.0      0   \n",
       "23                        Sloper, Mr. William Thompson    male  28.0      0   \n",
       "24                       Palsson, Miss. Torborg Danira  female   8.0      3   \n",
       "25   Asplund, Mrs. Carl Oscar (Selma Augusta Emilia...  female  38.0      1   \n",
       "26                             Emir, Mr. Farred Chehab    male   NaN      0   \n",
       "27                      Fortune, Mr. Charles Alexander    male  19.0      3   \n",
       "28                       O'Dwyer, Miss. Ellen \"Nellie\"  female   NaN      0   \n",
       "29                                 Todoroff, Mr. Lalio    male   NaN      0   \n",
       "..                                                 ...     ...   ...    ...   \n",
       "861                        Giles, Mr. Frederick Edward    male  21.0      1   \n",
       "862  Swift, Mrs. Frederick Joel (Margaret Welles Ba...  female  48.0      0   \n",
       "863                  Sage, Miss. Dorothy Edith \"Dolly\"  female   NaN      8   \n",
       "864                             Gill, Mr. John William    male  24.0      0   \n",
       "865                           Bystrom, Mrs. (Karolina)  female  42.0      0   \n",
       "866                       Duran y More, Miss. Asuncion  female  27.0      1   \n",
       "867               Roebling, Mr. Washington Augustus II    male  31.0      0   \n",
       "868                        van Melkebeke, Mr. Philemon    male   NaN      0   \n",
       "869                    Johnson, Master. Harold Theodor    male   4.0      1   \n",
       "870                                  Balkic, Mr. Cerin    male  26.0      0   \n",
       "871   Beckwith, Mrs. Richard Leonard (Sallie Monypeny)  female  47.0      1   \n",
       "872                           Carlsson, Mr. Frans Olof    male  33.0      0   \n",
       "873                        Vander Cruyssen, Mr. Victor    male  47.0      0   \n",
       "874              Abelson, Mrs. Samuel (Hannah Wizosky)  female  28.0      1   \n",
       "875                   Najib, Miss. Adele Kiamie \"Jane\"  female  15.0      0   \n",
       "876                      Gustafsson, Mr. Alfred Ossian    male  20.0      0   \n",
       "877                               Petroff, Mr. Nedelio    male  19.0      0   \n",
       "878                                 Laleff, Mr. Kristo    male   NaN      0   \n",
       "879      Potter, Mrs. Thomas Jr (Lily Alexenia Wilson)  female  56.0      0   \n",
       "880       Shelley, Mrs. William (Imanita Parrish Hall)  female  25.0      0   \n",
       "881                                 Markun, Mr. Johann    male  33.0      0   \n",
       "882                       Dahlberg, Miss. Gerda Ulrika  female  22.0      0   \n",
       "883                      Banfield, Mr. Frederick James    male  28.0      0   \n",
       "884                             Sutehall, Mr. Henry Jr    male  25.0      0   \n",
       "885               Rice, Mrs. William (Margaret Norton)  female  39.0      0   \n",
       "886                              Montvila, Rev. Juozas    male  27.0      0   \n",
       "887                       Graham, Miss. Margaret Edith  female  19.0      0   \n",
       "888           Johnston, Miss. Catherine Helen \"Carrie\"  female   NaN      1   \n",
       "889                              Behr, Mr. Karl Howell    male  26.0      0   \n",
       "890                                Dooley, Mr. Patrick    male  32.0      0   \n",
       "\n",
       "     Parch            Ticket      Fare        Cabin Embarked  \n",
       "0        0         A/5 21171    7.2500          NaN        S  \n",
       "1        0          PC 17599   71.2833          C85        C  \n",
       "2        0  STON/O2. 3101282    7.9250          NaN        S  \n",
       "3        0            113803   53.1000         C123        S  \n",
       "4        0            373450    8.0500          NaN        S  \n",
       "5        0            330877    8.4583          NaN        Q  \n",
       "6        0             17463   51.8625          E46        S  \n",
       "7        1            349909   21.0750          NaN        S  \n",
       "8        2            347742   11.1333          NaN        S  \n",
       "9        0            237736   30.0708          NaN        C  \n",
       "10       1           PP 9549   16.7000           G6        S  \n",
       "11       0            113783   26.5500         C103        S  \n",
       "12       0         A/5. 2151    8.0500          NaN        S  \n",
       "13       5            347082   31.2750          NaN        S  \n",
       "14       0            350406    7.8542          NaN        S  \n",
       "15       0            248706   16.0000          NaN        S  \n",
       "16       1            382652   29.1250          NaN        Q  \n",
       "17       0            244373   13.0000          NaN        S  \n",
       "18       0            345763   18.0000          NaN        S  \n",
       "19       0              2649    7.2250          NaN        C  \n",
       "20       0            239865   26.0000          NaN        S  \n",
       "21       0            248698   13.0000          D56        S  \n",
       "22       0            330923    8.0292          NaN        Q  \n",
       "23       0            113788   35.5000           A6        S  \n",
       "24       1            349909   21.0750          NaN        S  \n",
       "25       5            347077   31.3875          NaN        S  \n",
       "26       0              2631    7.2250          NaN        C  \n",
       "27       2             19950  263.0000  C23 C25 C27        S  \n",
       "28       0            330959    7.8792          NaN        Q  \n",
       "29       0            349216    7.8958          NaN        S  \n",
       "..     ...               ...       ...          ...      ...  \n",
       "861      0             28134   11.5000          NaN        S  \n",
       "862      0             17466   25.9292          D17        S  \n",
       "863      2          CA. 2343   69.5500          NaN        S  \n",
       "864      0            233866   13.0000          NaN        S  \n",
       "865      0            236852   13.0000          NaN        S  \n",
       "866      0     SC/PARIS 2149   13.8583          NaN        C  \n",
       "867      0          PC 17590   50.4958          A24        S  \n",
       "868      0            345777    9.5000          NaN        S  \n",
       "869      1            347742   11.1333          NaN        S  \n",
       "870      0            349248    7.8958          NaN        S  \n",
       "871      1             11751   52.5542          D35        S  \n",
       "872      0               695    5.0000  B51 B53 B55        S  \n",
       "873      0            345765    9.0000          NaN        S  \n",
       "874      0         P/PP 3381   24.0000          NaN        C  \n",
       "875      0              2667    7.2250          NaN        C  \n",
       "876      0              7534    9.8458          NaN        S  \n",
       "877      0            349212    7.8958          NaN        S  \n",
       "878      0            349217    7.8958          NaN        S  \n",
       "879      1             11767   83.1583          C50        C  \n",
       "880      1            230433   26.0000          NaN        S  \n",
       "881      0            349257    7.8958          NaN        S  \n",
       "882      0              7552   10.5167          NaN        S  \n",
       "883      0  C.A./SOTON 34068   10.5000          NaN        S  \n",
       "884      0   SOTON/OQ 392076    7.0500          NaN        S  \n",
       "885      5            382652   29.1250          NaN        Q  \n",
       "886      0            211536   13.0000          NaN        S  \n",
       "887      0            112053   30.0000          B42        S  \n",
       "888      2        W./C. 6607   23.4500          NaN        S  \n",
       "889      0            111369   30.0000         C148        C  \n",
       "890      0            370376    7.7500          NaN        Q  \n",
       "\n",
       "[891 rows x 12 columns]"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('train.csv')\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PassengerId</th>\n",
       "      <th>Survived</th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Name</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Ticket</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Cabin</th>\n",
       "      <th>Embarked</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Braund, Mr. Owen Harris</td>\n",
       "      <td>1</td>\n",
       "      <td>22.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>A/5 21171</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>\n",
       "      <td>0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>PC 17599</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>82</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>Heikkinen, Miss. Laina</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>STON/O2. 3101282</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>\n",
       "      <td>0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>113803</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>56</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>Allen, Mr. William Henry</td>\n",
       "      <td>1</td>\n",
       "      <td>35.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>373450</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   PassengerId  Survived  Pclass  \\\n",
       "0            1         0       3   \n",
       "1            2         1       1   \n",
       "2            3         1       3   \n",
       "3            4         1       1   \n",
       "4            5         0       3   \n",
       "\n",
       "                                                Name  Sex   Age  SibSp  Parch  \\\n",
       "0                            Braund, Mr. Owen Harris    1  22.0      1      0   \n",
       "1  Cumings, Mrs. John Bradley (Florence Briggs Th...    0  38.0      1      0   \n",
       "2                             Heikkinen, Miss. Laina    0  26.0      0      0   \n",
       "3       Futrelle, Mrs. Jacques Heath (Lily May Peel)    0  35.0      1      0   \n",
       "4                           Allen, Mr. William Henry    1  35.0      0      0   \n",
       "\n",
       "             Ticket     Fare  Cabin  Embarked  \n",
       "0         A/5 21171   7.2500      0         3  \n",
       "1          PC 17599  71.2833     82         1  \n",
       "2  STON/O2. 3101282   7.9250      0         3  \n",
       "3            113803  53.1000     56         3  \n",
       "4            373450   8.0500      0         3  "
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Age'] = df.Age.fillna(df.Age.mean())\n",
    "df = df.where((pd.notnull(df)), 0)\n",
    "for f in [\"Sex\", \"Embarked\", \"Cabin\"]:\n",
    "    df[f] = df[f].astype('category')\n",
    "    df[f] = df[f].cat.codes\n",
    "\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Embarked</th>\n",
       "      <th>Cabin</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Pclass</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.131900</td>\n",
       "      <td>-0.331339</td>\n",
       "      <td>0.083081</td>\n",
       "      <td>0.018443</td>\n",
       "      <td>-0.549500</td>\n",
       "      <td>0.173511</td>\n",
       "      <td>-0.537419</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Sex</th>\n",
       "      <td>0.131900</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.084153</td>\n",
       "      <td>-0.114631</td>\n",
       "      <td>-0.245489</td>\n",
       "      <td>-0.182333</td>\n",
       "      <td>0.118492</td>\n",
       "      <td>-0.137704</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Age</th>\n",
       "      <td>-0.331339</td>\n",
       "      <td>0.084153</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.232625</td>\n",
       "      <td>-0.179191</td>\n",
       "      <td>0.091566</td>\n",
       "      <td>-0.039610</td>\n",
       "      <td>0.157950</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SibSp</th>\n",
       "      <td>0.083081</td>\n",
       "      <td>-0.114631</td>\n",
       "      <td>-0.232625</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.414838</td>\n",
       "      <td>0.159651</td>\n",
       "      <td>0.071480</td>\n",
       "      <td>-0.024829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Parch</th>\n",
       "      <td>0.018443</td>\n",
       "      <td>-0.245489</td>\n",
       "      <td>-0.179191</td>\n",
       "      <td>0.414838</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.216225</td>\n",
       "      <td>0.043351</td>\n",
       "      <td>0.033585</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fare</th>\n",
       "      <td>-0.549500</td>\n",
       "      <td>-0.182333</td>\n",
       "      <td>0.091566</td>\n",
       "      <td>0.159651</td>\n",
       "      <td>0.216225</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.230365</td>\n",
       "      <td>0.310987</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Embarked</th>\n",
       "      <td>0.173511</td>\n",
       "      <td>0.118492</td>\n",
       "      <td>-0.039610</td>\n",
       "      <td>0.071480</td>\n",
       "      <td>0.043351</td>\n",
       "      <td>-0.230365</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.070245</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cabin</th>\n",
       "      <td>-0.537419</td>\n",
       "      <td>-0.137704</td>\n",
       "      <td>0.157950</td>\n",
       "      <td>-0.024829</td>\n",
       "      <td>0.033585</td>\n",
       "      <td>0.310987</td>\n",
       "      <td>-0.070245</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            Pclass       Sex       Age     SibSp     Parch      Fare  \\\n",
       "Pclass    1.000000  0.131900 -0.331339  0.083081  0.018443 -0.549500   \n",
       "Sex       0.131900  1.000000  0.084153 -0.114631 -0.245489 -0.182333   \n",
       "Age      -0.331339  0.084153  1.000000 -0.232625 -0.179191  0.091566   \n",
       "SibSp     0.083081 -0.114631 -0.232625  1.000000  0.414838  0.159651   \n",
       "Parch     0.018443 -0.245489 -0.179191  0.414838  1.000000  0.216225   \n",
       "Fare     -0.549500 -0.182333  0.091566  0.159651  0.216225  1.000000   \n",
       "Embarked  0.173511  0.118492 -0.039610  0.071480  0.043351 -0.230365   \n",
       "Cabin    -0.537419 -0.137704  0.157950 -0.024829  0.033585  0.310987   \n",
       "\n",
       "          Embarked     Cabin  \n",
       "Pclass    0.173511 -0.537419  \n",
       "Sex       0.118492 -0.137704  \n",
       "Age      -0.039610  0.157950  \n",
       "SibSp     0.071480 -0.024829  \n",
       "Parch     0.043351  0.033585  \n",
       "Fare     -0.230365  0.310987  \n",
       "Embarked  1.000000 -0.070245  \n",
       "Cabin    -0.070245  1.000000  "
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "features = [\"Pclass\",\"Sex\",\"Age\",\"SibSp\",\"Parch\",\"Fare\",\"Embarked\", \"Cabin\"]\n",
    "df[features].corr()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Iremos remover a feature Cabin, pois a sua informaÃ§Ã£o Ã© quase redundante a Pclass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Pclass</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>SibSp</th>\n",
       "      <th>Parch</th>\n",
       "      <th>Fare</th>\n",
       "      <th>Embarked</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2500</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>38.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>71.2833</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.9250</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>35.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>53.1000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>35.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.4583</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>54.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>51.8625</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>21.0750</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>11.1333</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>30.0708</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>16.7000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>58.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>26.5500</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0500</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>39.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>31.2750</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>14.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.8542</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>55.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>16.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>29.1250</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>31.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>18.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>35.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>34.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>15.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>8.0292</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>35.5000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>21.0750</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>38.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>31.3875</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>19.000000</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>263.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.8792</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>861</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>21.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>11.5000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>862</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>48.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>25.9292</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>863</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>69.5500</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>864</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>24.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>865</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>42.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>866</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>13.8583</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>867</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>31.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>50.4958</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>868</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9.5000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>869</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>11.1333</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>870</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>871</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>47.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>52.5542</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>872</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>33.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>873</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>47.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>874</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>24.0000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>875</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>15.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.2250</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>876</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>20.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9.8458</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>877</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>19.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>878</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>879</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>56.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>83.1583</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>880</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>25.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>26.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>881</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>33.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.8958</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>882</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>22.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10.5167</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>883</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>28.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10.5000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>884</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>25.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.0500</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>885</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>39.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>29.1250</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>886</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>887</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>19.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30.0000</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>888</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>29.699118</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>23.4500</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>889</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>26.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30.0000</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>890</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>32.000000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>7.7500</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>891 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Pclass  Sex        Age  SibSp  Parch      Fare  Embarked\n",
       "0         3    1  22.000000      1      0    7.2500         3\n",
       "1         1    0  38.000000      1      0   71.2833         1\n",
       "2         3    0  26.000000      0      0    7.9250         3\n",
       "3         1    0  35.000000      1      0   53.1000         3\n",
       "4         3    1  35.000000      0      0    8.0500         3\n",
       "5         3    1  29.699118      0      0    8.4583         2\n",
       "6         1    1  54.000000      0      0   51.8625         3\n",
       "7         3    1   2.000000      3      1   21.0750         3\n",
       "8         3    0  27.000000      0      2   11.1333         3\n",
       "9         2    0  14.000000      1      0   30.0708         1\n",
       "10        3    0   4.000000      1      1   16.7000         3\n",
       "11        1    0  58.000000      0      0   26.5500         3\n",
       "12        3    1  20.000000      0      0    8.0500         3\n",
       "13        3    1  39.000000      1      5   31.2750         3\n",
       "14        3    0  14.000000      0      0    7.8542         3\n",
       "15        2    0  55.000000      0      0   16.0000         3\n",
       "16        3    1   2.000000      4      1   29.1250         2\n",
       "17        2    1  29.699118      0      0   13.0000         3\n",
       "18        3    0  31.000000      1      0   18.0000         3\n",
       "19        3    0  29.699118      0      0    7.2250         1\n",
       "20        2    1  35.000000      0      0   26.0000         3\n",
       "21        2    1  34.000000      0      0   13.0000         3\n",
       "22        3    0  15.000000      0      0    8.0292         2\n",
       "23        1    1  28.000000      0      0   35.5000         3\n",
       "24        3    0   8.000000      3      1   21.0750         3\n",
       "25        3    0  38.000000      1      5   31.3875         3\n",
       "26        3    1  29.699118      0      0    7.2250         1\n",
       "27        1    1  19.000000      3      2  263.0000         3\n",
       "28        3    0  29.699118      0      0    7.8792         2\n",
       "29        3    1  29.699118      0      0    7.8958         3\n",
       "..      ...  ...        ...    ...    ...       ...       ...\n",
       "861       2    1  21.000000      1      0   11.5000         3\n",
       "862       1    0  48.000000      0      0   25.9292         3\n",
       "863       3    0  29.699118      8      2   69.5500         3\n",
       "864       2    1  24.000000      0      0   13.0000         3\n",
       "865       2    0  42.000000      0      0   13.0000         3\n",
       "866       2    0  27.000000      1      0   13.8583         1\n",
       "867       1    1  31.000000      0      0   50.4958         3\n",
       "868       3    1  29.699118      0      0    9.5000         3\n",
       "869       3    1   4.000000      1      1   11.1333         3\n",
       "870       3    1  26.000000      0      0    7.8958         3\n",
       "871       1    0  47.000000      1      1   52.5542         3\n",
       "872       1    1  33.000000      0      0    5.0000         3\n",
       "873       3    1  47.000000      0      0    9.0000         3\n",
       "874       2    0  28.000000      1      0   24.0000         1\n",
       "875       3    0  15.000000      0      0    7.2250         1\n",
       "876       3    1  20.000000      0      0    9.8458         3\n",
       "877       3    1  19.000000      0      0    7.8958         3\n",
       "878       3    1  29.699118      0      0    7.8958         3\n",
       "879       1    0  56.000000      0      1   83.1583         1\n",
       "880       2    0  25.000000      0      1   26.0000         3\n",
       "881       3    1  33.000000      0      0    7.8958         3\n",
       "882       3    0  22.000000      0      0   10.5167         3\n",
       "883       2    1  28.000000      0      0   10.5000         3\n",
       "884       3    1  25.000000      0      0    7.0500         3\n",
       "885       3    0  39.000000      0      5   29.1250         2\n",
       "886       2    1  27.000000      0      0   13.0000         3\n",
       "887       1    0  19.000000      0      0   30.0000         3\n",
       "888       3    0  29.699118      1      2   23.4500         3\n",
       "889       1    1  26.000000      0      0   30.0000         1\n",
       "890       3    1  32.000000      0      0    7.7500         2\n",
       "\n",
       "[891 rows x 7 columns]"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "features.remove('Cabin')\n",
    "X = df.get(features)\n",
    "X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1,\n",
       "       1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0,\n",
       "       0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1,\n",
       "       0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0,\n",
       "       0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0,\n",
       "       0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0,\n",
       "       0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0,\n",
       "       1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,\n",
       "       1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0,\n",
       "       1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0,\n",
       "       1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0,\n",
       "       0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1,\n",
       "       0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1,\n",
       "       1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0,\n",
       "       1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0,\n",
       "       1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1,\n",
       "       1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1,\n",
       "       1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0,\n",
       "       1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0,\n",
       "       1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0,\n",
       "       1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0,\n",
       "       1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0,\n",
       "       1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0,\n",
       "       0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0,\n",
       "       0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0,\n",
       "       0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0,\n",
       "       0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0,\n",
       "       1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1,\n",
       "       1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0,\n",
       "       0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1,\n",
       "       1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1,\n",
       "       0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0,\n",
       "       0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0,\n",
       "       1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1,\n",
       "       0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1,\n",
       "       0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1,\n",
       "       1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0,\n",
       "       0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0,\n",
       "       1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0])"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Y = df[\"Survived\"].values\n",
    "Y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Particionar o dataset\n",
    "X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "knn = KNeighborsClassifier()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n",
       "           metric_params=None, n_jobs=1, n_neighbors=5, p=2,\n",
       "           weights='uniform')"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "knn.fit(X_train,Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [],
   "source": [
    "resultado = knn.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.6905829596412556"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(Y_test, resultado)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "scores = []\n",
    "ks = range(1,30, 4)\n",
    "n_ks = len(ks)\n",
    "\n",
    "for k in ks:\n",
    "    knn = KNeighborsClassifier(n_neighbors=k)\n",
    "    knn.fit(X_train,Y_train)\n",
    "    scores.append(knn.score(X_test,Y_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x7f99140203c8>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig,ax = plt.subplots()\n",
    "ax.plot(ks,scores,'b',linewidth=3)\n",
    "ax.set_ylabel('Accuracy')\n",
    "ax.set_xlabel('K Neighbors')\n",
    "plt.title('Accuracy')\n",
    "plt.grid()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.71300448430493268"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "max(scores)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "13"
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bestK = scores.index(max(scores))\n",
    "bestK = bestK*4 +1\n",
    "bestK"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',\n",
       "           metric_params=None, n_jobs=1, n_neighbors=13, p=2,\n",
       "           weights='uniform')"
      ]
     },
     "execution_count": 70,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "knn = KNeighborsClassifier(n_neighbors=bestK)\n",
    "knn.fit(X_train,Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [],
   "source": [
    "result = knn.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.71300448430493268"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "acr = accuracy_score(Y_test, result)\n",
    "acr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "             precision    recall  f1-score   support\n",
      "\n",
      "          0       0.86      0.71      0.78       160\n",
      "          1       0.49      0.71      0.58        63\n",
      "\n",
      "avg / total       0.76      0.71      0.73       223\n",
      "\n"
     ]
    }
   ],
   "source": [
    "report = classification_report(knn.predict(X_test), Y_test)\n",
    "print(report)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [],
   "source": [
    "knn = KNNClassifier()\n",
    "knn.fit(X_train.values, Y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [],
   "source": [
    "resultado = knn.predict(X_test.values, k=bestK)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "             precision    recall  f1-score   support\n",
      "\n",
      "          0       0.87      0.71      0.78       162\n",
      "          1       0.48      0.72      0.58        61\n",
      "\n",
      "avg / total       0.77      0.71      0.73       223\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(classification_report(resultado, Y_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.71300448430493268"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(Y_test, resultado)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
